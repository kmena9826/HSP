@model CS_HOSPITALARIO.Models.SpListadoExamenLaboratorio_Result
@{
    ViewBag.Title = "Registrar Toma Muestra";
}
<link href="~/Content/animate.css" rel="stylesheet" />
<style>
    [data-notify="progressbar"] {
        margin-bottom: 0px;
        position: absolute;
        bottom: 0px;
        left: 0px;
        width: 100%;
        height: 5px;
    }
</style>
<script src="~/Scripts/vendor.js"></script>
<link href="~/Content/dx.common.css" rel="stylesheet" />
<link href="~/Content/dx.light.css" rel="stylesheet" />
<div class="row m-0 gap-20 masonry pos-r">
    <div class="masonry-item w-100">
        <div class="row gap-20">
            <div class="masonry-item col-md-12 col-sm-12">
                <div class="bd bgc-white">
                    <div class="layers">
                        <div class="ta-c w-100 p-10">
                            <h4 class="float-left"><span class="color-secondary-h text-uppercase">@ViewBag.Title</span></h4>
                            <nav class="float-right m-0" aria-label="breadcrumb">
                                <ol class="breadcrumb bg-color-blanco">
                                    <li class="breadcrumb-item"><a href="@Url.Action("Index","Home")">Principal</a></li>
                                    <li class="breadcrumb-item"><a href="@Url.Action("Index","Admision")">Toma De Muestra</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">@ViewBag.Title</li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row m-0 gap-20 masonry pos-r">
    <div class="masonry-item w-100">
        <div class="row gap-20">
            <div class="masonry-item col-md-12 col-sm-12">
                <div class="bgc-white p-20 bd">
                    @*@using (Html.BeginForm())
                        {*@
                    @Html.HiddenFor(model => model.ED)
                    @Html.HiddenFor(model => model.NUM_MUESTRA)
                    <div class="row">
                        <div class="col-md-5">
                            <h4>Nº de Muestra: @Model.NUM_MUESTRA</h4>
                        </div>
                        <div class="form-group ml-auto">
                            <button class="btn btn-primary" id="btnregistaratoma">Imprimir Etiqueta</button>
                            @*<input type="submit" value="Emprimir Etiqueta" class="btn btn-primary" id="btnregistaratoma" />*@
                            @Html.ActionLink("Cancelar", "TomaMuestra", "Laboratorio", null, new { @class = "btn btn-outline-secondary" })
                        </div>
                    </div>
                    <hr />
                    <div>
                        <fieldset disabled>
                            <div class="form-group row">
                                <label for="ADMISION" class="col-sm-2 col-form-label" style="text-align:right">Nº Admision:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.ADMISION, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row" style="display:none">

                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.ED, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="CLIENTE_ID" class="col-sm-2 col-form-label" style="text-align:right">Cod Cliente:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.CLIENTE_ID, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="CLIENTE" class="col-sm-2 col-form-label" style="text-align:right">Cliente:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.CLIENTE, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="ID_EXAMEN" class="col-sm-2 col-form-label" style="text-align:right">Cod Examen:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.ARTICULO, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="DESC_ARTICULO" class="col-sm-2 col-form-label" style="text-align:right">Examen:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.DESC_ARTICULO, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="STAT" class="col-sm-2 col-form-label" style="text-align:right">STAT:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.STAT)
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="FECHA_CREACION" class="col-sm-2 col-form-label" style="text-align:right">Fecha Admision:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.FECHA_CREACION, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="EDAD" class="col-sm-2 col-form-label" style="text-align:right">Edad Al Tomar La Muestra:</label>
                                <div class="col-md-8">
                                    @Html.EditorFor(model => model.EDAD, new { htmlAttributes = new { @class = "form-control" } })
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    @*}*@
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts
{
    <link href="~/Content/select2.css" rel="stylesheet" />
    <script src="~/Scripts/select2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#btnregistaratoma').click(function () {
                let NUM_MUESTRA = $("#NUM_MUESTRA").val();
                let ED = $("#ED").val();
                $.ajax({
                    type: "POST",
                    url: '/Laboratorio/RegistrarTomaMuestra',
                    data: { NUM_MUESTRA, ED },
                    success: function (data) {
                        if (data.status) {
                            window.open('/Laboratorio/FormartoEmprimirEtiqueta?muestra=' + NUM_MUESTRA, '_blank');
                            location.href = '../TomaMuestra';
                        }
                    },
                    error: function () {
                        alert('Failed');
                    }
                })

            })
        });
    </script>
}